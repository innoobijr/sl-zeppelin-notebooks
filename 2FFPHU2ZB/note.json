{
  "paragraphs": [
    {
      "text": "%spark.pyspark\r\n\r\n\u0027\u0027\u0027\r\n * title:generalQueries\r\n * author: Prabhakar Kafle\r\n * description: \r\n\u0027\u0027\u0027\r\n\r\nimport pandas as pd\r\nimport numpy as np\r\nimport matplotlib.pyplot as plt\r\nimport os\r\n\r\nfrom pyspark.sql import SQLContext\r\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType\r\nfrom pyspark.sql.functions import split, lower\r\nimport pyspark.sql.functions as F\r\nfrom pyspark import StorageLevel",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:25:05.587",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1594393497137_1475168312",
      "id": "20200710-150457_1872181280",
      "dateCreated": "2020-07-10 15:04:57.137",
      "dateStarted": "2020-07-15 19:25:05.619",
      "dateFinished": "2020-07-15 19:25:05.628",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nACCESS_KEY \u003d os.environ[\u0027AWS_ID\u0027]\nSECRET_KEY \u003d os.environ[\u0027AWS_SECRET\u0027]\n\nsc._jsc.hadoopConfiguration().set(\"fs.s3n.awsAccessKeyId\", ACCESS_KEY)\nsc._jsc.hadoopConfiguration().set(\"fs.s3n.awsSecretAccessKey\", SECRET_KEY)\n\nsq \u003d SQLContext(sc)",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:25:07.046",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1594393547728_-440712632",
      "id": "20200710-150547_1252732811",
      "dateCreated": "2020-07-10 15:05:47.728",
      "dateStarted": "2020-07-15 19:25:07.071",
      "dateFinished": "2020-07-15 19:25:07.079",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nuserDaily \u003d sq.read.csv(\"s3n://sierra-leone-lake/blob/AGGREGATED_CDRS/africell/summaries/user_queries-daily/*.csv\", header\u003d\"true\", inferSchema\u003d\"true\")\n# userHourly \u003d sq.read.csv(\"s3n://sierra-leone-lake/blob/AGGREGATED_CDRS/africell/summaries/user_queries-hourly/*.csv\", header\u003d\"true\", inferSchema\u003d\"true\")\n\nuserDaily.persist(StorageLevel.DISK_ONLY)\n# userHourly.persist(StorageLevel.DISK_ONLY)",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:25:10.293",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "DataFrame[subscriber: string, call_date: timestamp, count: int]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1594393553627_-980919199",
      "id": "20200710-150553_81929267",
      "dateCreated": "2020-07-10 15:05:53.627",
      "dateStarted": "2020-07-15 19:25:10.321",
      "dateFinished": "2020-07-15 19:36:51.490",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nuserDaily.show()",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 16:00:32.217",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-------------------+-----+\n|          subscriber|          call_date|count|\n+--------------------+-------------------+-----+\n|7E308F5F262553155...|2020-05-03 00:00:00|   39|\n|CC4DC69009DB1C208...|2020-05-03 00:00:00|   65|\n|E3267769938ADA918...|2020-05-03 00:00:00|    9|\n|1FBC4080F09BB323F...|2020-05-03 00:00:00|   16|\n|3419ABFB42CC94708...|2020-05-03 00:00:00|    8|\n|6EEF121E33BCB3B1C...|2020-05-03 00:00:00|    5|\n|C463732636C529CB1...|2020-05-03 00:00:00|   15|\n|464ED0D1A09D48283...|2020-05-03 00:00:00|    5|\n|41607507606F2A9AD...|2020-05-03 00:00:00|   12|\n|D92CBE1C1249AC729...|2020-05-03 00:00:00|   35|\n|39C54F55B9FD53221...|2020-05-03 00:00:00|   41|\n|84CC707A98EB011E7...|2020-05-03 00:00:00|   16|\n|E7E0115DEF5BAE64F...|2020-05-03 00:00:00|    4|\n|666CB1D3255EDC246...|2020-05-03 00:00:00|    3|\n|518E3D3B98F1C15C2...|2020-05-03 00:00:00|    9|\n|1E0D48CD1FDB365E6...|2020-05-03 00:00:00|    3|\n|241A446E16EEDFA67...|2020-05-03 00:00:00|    7|\n|F33D431F46A2D8DA3...|2020-05-03 00:00:00|    5|\n|E8A85F7C9F58011E6...|2020-05-03 00:00:00|   45|\n|E82EF121A659E9E2C...|2020-05-03 00:00:00|   20|\n+--------------------+-------------------+-----+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1594394443928_1972247359",
      "id": "20200710-152043_211412540",
      "dateCreated": "2020-07-10 15:20:43.928",
      "dateStarted": "2020-07-15 16:00:32.289",
      "dateFinished": "2020-07-15 16:10:58.424",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\nuserHourly.describe().show()",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 20:19:53.153",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+-------+------------------+\n|summary|          subscriber|   hour|             count|\n+-------+--------------------+-------+------------------+\n|  count|             3391635|3391636|           3391636|\n|   mean|            Infinity|    0.0| 770.7625841924074|\n| stddev|                 NaN|    0.0|1440.3656152802055|\n|    min|0000061115E4683E6...|      0|                 1|\n|    max|FFFFEFDB109C1FD5D...|      0|            894101|\n+-------+--------------------+-------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1594606684465_1767404200",
      "id": "20200713-021804_1121487728",
      "dateCreated": "2020-07-13 02:18:04.465",
      "dateStarted": "2020-07-15 15:54:14.541",
      "dateFinished": "2020-07-15 15:55:24.408",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\navgUser \u003d userDaily.groupBy(\u0027subscriber\u0027).agg(F.avg(\u0027count\u0027).alias(\u0027avgCount\u0027))",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 17:18:53.604",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1594784895286_-807515829",
      "id": "20200715-034815_965955033",
      "dateCreated": "2020-07-15 03:48:15.286",
      "dateStarted": "2020-07-15 17:18:53.686",
      "dateFinished": "2020-07-15 17:30:48.422",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\navgUser.show()",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:46:04.824",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "Fail to execute line 1: avgUser.show()\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-4326945817205543154.py\", line 380, in \u003cmodule\u003e\n    exec(code, _zcUserQueryNameSpace)\n  File \"\u003cstdin\u003e\", line 1, in \u003cmodule\u003e\n  File \"/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/dataframe.py\", line 381, in show\n    print(self._jdf.showString(n, 20, vertical))\n  File \"/usr/local/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1255, in __call__\n    answer \u003d self.gateway_client.send_command(command)\n  File \"/usr/local/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 985, in send_command\n    response \u003d connection.send_command(command)\n  File \"/usr/local/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1152, in send_command\n    answer \u003d smart_decode(self.stream.readline()[:-1])\n  File \"/opt/anaconda/lib/python3.7/socket.py\", line 589, in readinto\n    return self._sock.recv_into(b)\n  File \"/usr/local/spark/python/lib/pyspark.zip/pyspark/context.py\", line 270, in signal_handler\n    raise KeyboardInterrupt()\nKeyboardInterrupt\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1594761538857_1203829008",
      "id": "20200714-211858_1488169245",
      "dateCreated": "2020-07-14 21:18:58.857",
      "dateStarted": "2020-07-15 19:46:04.852",
      "dateFinished": "2020-07-15 19:46:12.868",
      "status": "ABORT",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\navgUser.count()",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:37:41.099",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "3391636\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1594829523639_-714364742",
      "id": "20200715-161203_641203870",
      "dateCreated": "2020-07-15 16:12:03.639",
      "dateStarted": "2020-07-15 19:37:41.141",
      "dateFinished": "2020-07-15 19:41:37.548",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ndef bin_count(count):\n    if count\u003d\u003d0: \n        return \u00270\u0027\n    elif 0\u003ccount\u003c\u003d1:\n        return \u00270-1\u0027\n    elif 1\u003ccount\u003c\u003d3:\n        return \u00271-3\u0027\n    elif 3\u003ccount\u003c\u003d5:\n        return \u00273-5\u0027\n    elif 5\u003ccount\u003c\u003d10:\n        return \u00275-10\u0027\n    elif 10\u003ccount\u003c\u003d15:\n        return \u002710-15\u0027\n    elif 15\u003ccount\u003c\u003d20:\n        return \u002715-20\u0027\n    elif 20\u003ccount\u003c\u003d30:\n        return \u002720-30\u0027\n    elif 30\u003ccount\u003c\u003d50:\n        return \u002730-50\u0027\n    elif 50\u003ccount\u003c\u003d75:\n        return \u002750-75\u0027\n    elif 75\u003ccount\u003c\u003d100:\n        return \u002775-100\u0027\n    elif 100\u003ccount\u003c\u003d150:\n        return \u0027100-150\u0027\n    elif 150\u003ccount\u003c\u003d250:\n        return \u0027150-250\u0027\n    elif 250\u003ccount\u003c\u003d350:\n        return \u0027250-350\u0027\n    else:\n        return \u0027350-inf\u0027\n\nbin \u003d F.udf(bin_count, StringType())",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:33:17.983",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1594762331356_70245105",
      "id": "20200714-213211_908866194",
      "dateCreated": "2020-07-14 21:32:11.356",
      "dateStarted": "2020-07-15 19:33:18.094",
      "dateFinished": "2020-07-15 19:36:51.499",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ncount_buckets \u003d avgUser.withColumn(\u0027bin\u0027, bin(F.col(\u0027avgCount\u0027)))\\\n        .groupBy(\u0027bin\u0027)\\\n        .agg(F.count(\u0027avgCount\u0027).alias(\u0027numUsers\u0027))\ncount_buckets.createOrReplaceTempView(\"count_buckets\")",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 17:19:09.820",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1594763801377_-950878169",
      "id": "20200714-215641_687920881",
      "dateCreated": "2020-07-14 21:56:41.377",
      "dateStarted": "2020-07-15 17:30:48.552",
      "dateFinished": "2020-07-15 17:30:48.855",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.sql\nselect * from count_buckets",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 17:57:12.047",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {
                    "columns": [
                      {
                        "name": "bin",
                        "visible": true,
                        "width": "*",
                        "sort": {
                          "priority": 0.0,
                          "direction": "desc"
                        },
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      },
                      {
                        "name": "numUsers",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      }
                    ],
                    "scrollFocus": {},
                    "selection": [],
                    "grouping": {
                      "grouping": [],
                      "aggregations": [],
                      "rowExpandedStates": {}
                    },
                    "treeView": {},
                    "pagination": {
                      "paginationCurrentPage": 1.0,
                      "paginationPageSize": 250.0
                    }
                  },
                  "tableColumnTypeState": {
                    "names": {
                      "bin": "string",
                      "numUsers": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "bin",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "numUsers",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "bin\tnumUsers\n30-50\t93234\n75-100\t4204\n250-350\t64\n150-250\t701\n20-30\t220016\n50-75\t17422\n100-150\t2319\n1-3\t528722\n15-20\t272216\n5-10\t943171\n10-15\t519426\n0-1\t279773\n\u003e350\t59\n3-5\t510309\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1594764396801_-828957704",
      "id": "20200714-220636_1654962021",
      "dateCreated": "2020-07-14 22:06:36.801",
      "dateStarted": "2020-07-15 17:30:48.921",
      "dateFinished": "2020-07-15 17:50:30.162",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\ndaily_pattern \u003d userDaily.groupBy(\u0027call_date\u0027)\\\n        .agg(F.count(\u0027subscriber\u0027).alias(\u0027users\u0027), F.avg(\u0027count\u0027).alias(\u0027per_user\u0027))\\\n        .orderBy(\u0027call_date\u0027)\ndaily_pattern.createOrReplaceTempView(\"daily_pattern\")",
      "user": "anonymous",
      "dateUpdated": "2020-07-14 16:21:32.554",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1594394701817_1118535483",
      "id": "20200710-152501_2015079295",
      "dateCreated": "2020-07-10 15:25:01.817",
      "dateStarted": "2020-07-13 03:39:29.453",
      "dateFinished": "2020-07-13 03:39:29.563",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.sql\nselect * from daily_pattern",
      "user": "anonymous",
      "dateUpdated": "2020-07-15 03:24:52.148",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "lineChart",
              "height": 300.0,
              "optionOpen": true,
              "setting": {
                "table": {
                  "tableGridState": {
                    "columns": [
                      {
                        "name": "call_date",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      },
                      {
                        "name": "per_user",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      },
                      {
                        "name": "users",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      }
                    ],
                    "scrollFocus": {},
                    "selection": [],
                    "grouping": {
                      "grouping": [],
                      "aggregations": [],
                      "rowExpandedStates": {}
                    },
                    "treeView": {},
                    "pagination": {
                      "paginationCurrentPage": 1.0,
                      "paginationPageSize": 250.0
                    }
                  },
                  "tableColumnTypeState": {
                    "names": {
                      "call_date": "string",
                      "users": "string",
                      "per_user": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "isDateFormat": true,
                  "dateFormat": "MMM-DD"
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "call_date",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "users",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1594394939078_-1920987238",
      "id": "20200710-152859_1576872658",
      "dateCreated": "2020-07-10 15:28:59.078",
      "dateStarted": "2020-07-13 03:39:32.523",
      "dateFinished": "2020-07-13 03:40:30.376",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\n\nweekly \u003d userDaily.withColumn(\u0027day\u0027, F.date_format(\u0027call_date\u0027, \u0027u\u0027))\\\n        .withColumn(\u0027week\u0027, F.weekofyear(\u0027call_date\u0027))\n# weekly_pattern \u003d weekly.groupBy(\u0027day\u0027, \u0027week\u0027)\\\n#         .agg(F.count(\u0027subscriber\u0027).alias(\u0027users\u0027), F.avg(\u0027count\u0027).alias(\u0027per_user\u0027))\\\n#         .orderBy(\u0027week\u0027, \u0027day\u0027)\n# weekly_pattern.createOrReplaceTempView(\"weekly_pattern\")",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:48:34.335",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1594395306109_1458532196",
      "id": "20200710-153506_794500049",
      "dateCreated": "2020-07-10 15:35:06.109",
      "dateStarted": "2020-07-15 19:47:38.925",
      "dateFinished": "2020-07-15 19:47:38.996",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.sql\nselect * from weekly_pattern",
      "user": "anonymous",
      "dateUpdated": "2020-07-15 03:39:59.719",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "lineChart",
              "height": 300.0,
              "optionOpen": true,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "day": "string",
                      "week": "string",
                      "users": "string",
                      "per_user": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "forceY": true,
                  "lineWithFocus": false
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "day",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [
                {
                  "name": "week",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ],
              "values": [
                {
                  "name": "per_user",
                  "index": 3.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1594605212766_829180437",
      "id": "20200713-015332_979584824",
      "dateCreated": "2020-07-13 01:53:32.766",
      "dateStarted": "2020-07-13 03:40:23.250",
      "dateFinished": "2020-07-13 03:43:20.086",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.pyspark\navgUserWeekly \u003d weekly.groupBy(\u0027subscriber\u0027, \u0027week\u0027).agg(F.sum(\u0027count\u0027).alias(\u0027avgCount\u0027)).groupBy(\u0027subscriber\u0027).agg(F.avg(\u0027avgCount\u0027).alias(\u0027avgCount\u0027))\nweekly_count_buckets \u003d avgUserWeekly.withColumn(\u0027bin\u0027, bin(F.col(\u0027avgCount\u0027)))\\\n        .groupBy(\u0027bin\u0027)\\\n        .agg(F.count(\u0027avgCount\u0027).alias(\u0027numUsers\u0027))\nweekly_count_buckets.createOrReplaceTempView(\"weekly_count_buckets\")",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 20:04:21.635",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1594611623217_-148754430",
      "id": "20200713-034023_337156806",
      "dateCreated": "2020-07-13 03:40:23.217",
      "dateStarted": "2020-07-15 20:04:21.659",
      "dateFinished": "2020-07-15 20:04:21.875",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.sql\nselect * from weekly_count_buckets",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 20:04:23.920",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "bin": "string",
                      "numUsers": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "bin",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "numUsers",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "bin\tnumUsers\n30-50\t533550\n75-100\t255145\n250-350\t20343\n150-250\t114807\n20-30\t355785\n50-75\t430027\n100-150\t236304\n1-3\t262702\n15-20\t209541\n5-10\t298955\n10-15\t241120\n0-1\t263321\n350-inf\t11630\n3-5\t158406\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1594836671324_-184306199",
      "id": "20200715-181111_1270249887",
      "dateCreated": "2020-07-15 18:11:11.324",
      "dateStarted": "2020-07-15 20:04:23.953",
      "dateFinished": "2020-07-15 20:11:24.448",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%spark.sql\n",
      "user": "prabhakar",
      "dateUpdated": "2020-07-15 19:50:16.767",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1594842616766_538484169",
      "id": "20200715-195016_1926744173",
      "dateCreated": "2020-07-15 19:50:16.766",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "MIT/userStats",
  "id": "2FFPHU2ZB",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}